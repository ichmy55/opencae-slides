name:  JOBS at push to main

on:
  push:
    branches:
      - main

permissions:
  contents: write
  packages: write
  pull-requests: write

jobs:
  package-textcomp:
    uses: ./.github/workflows/package-textcomp.yml

  release-drafter:
    needs: [package-textcomp]
    uses: ./.github/workflows/release-drafter.yml

  build-pdf:
    needs: [release-drafter]
    uses: ./.github/workflows/build-pdf.yml

  testw2:
    needs: [release-drafter,build-pdf]
    runs-on: ubuntu-latest
    steps:
      - name: job1からの出力を使用
        run: |
          echo qwe1
          echo ${{ needs.release-drafter.outputs.update_url }}
          echo qwe2
          echo ${{ needs.build-pdf.outputs.name_pdf }}
          echo qwe3

  release-update:
    needs: [release-drafter,build-pdf]
    uses: ./.github/workflows/release-update.yml
    with:
      upload_url:  ${{ needs.release-drafter.outputs.update_url }}
      name_pdf:    ${{ needs.build-pdf.outputs.name_pdf }}
